pollutantmean <- function(directory, pollutant, id = 1:332) {
  threeDigNumVec <- sprintf("%03d", id)
  filesToBeReadVec <- character()
  for (i in seq_along(threeDigNumVec)) {
    filesToBeReadVec[i] <- paste(directory, "/", threeDigNumVec[i], ".csv", sep="")
  }
  
  pollutantVector <- numeric()
  meanOfPollutant <- numeric()
  
  for (j in seq_along(filesToBeReadVec)) {
    currCSV <- read.csv(file=filesToBeReadVec[j], header=TRUE, sep=",")
    pollutantVector <- c(pollutantVector, currCSV[[pollutant]])
  }
  
  meanOfPollutant <- mean(pollutantVector, na.rm=TRUE)
  
  meanOfPollutant
}

complete <- function(directory, id = 1:332) {
  threeDigNumVec <- sprintf("%03d", id)
  filesToBeReadVec <- character()
  for (i in seq_along(threeDigNumVec)) {
    filesToBeReadVec[i] <- paste(directory, "/", threeDigNumVec[i], ".csv", sep="")
  }
  
  nobsVec <- numeric()
  for (j in seq_along(filesToBeReadVec)) {
    currCSV <- read.csv(file=filesToBeReadVec[j], header=TRUE, sep=",")
    currNobsSum <- nrow(currCSV[complete.cases(currCSV), ])
    nobsVec <- c(nobsVec, currNobsSum)
  }
  
  completeDataFrame <- data.frame(id = id, nobs = nobsVec)
  completeDataFrame
  
}

corr <- function(directory, threshold = 0) {
  ## 'directory' is a character vector of length 1 indicating
  ## the location of the CSV files
  
  ## 'threshold' is a numeric vector of length 1 indicating the
  ## number of completely observed observations (on all
  ## variables) required to computer the correlation between
  ## nitrate and sulfate; the default is 0.
  
  ## Return a numeric vector of correlations.
  ## NOTE: Do not round the result!
  
  corrVec <- numeric()
  completeDataFrame <- complete(directory)
  
  fileNames <- Sys.glob(paste(directory, "/", "*.csv", sep=""))
  for (i in 1:nrow(completeDataFrame)) {
    if (completeDataFrame[i, 2] >= threshold) {
      currFile <- read.csv(fileNames[i], header=TRUE, sep=",")
      currFile <- currFile[complete.cases(currFile), ]
      corrVec <- c(corrVec, cor(currFile$sulfate, currFile$nitrate))
    }
  }
  
  corrVec
  
}